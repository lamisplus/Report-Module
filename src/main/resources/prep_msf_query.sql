WITH prepData AS ( SELECT DISTINCT p.uuid AS personUuid, p.sex,
                                   p.facility_id,
                                   DATE_PART('year', AGE(p.date_of_birth)) AS age
                   FROM
                       patient_person p
                           INNER JOIN
                       prep_enrollment pe ON pe.person_uuid = p.uuid
                   WHERE
                       p.archived = 0 AND p.facility_id = :facilityId
),

     prepClinic AS (
         SELECT
             person_uuid AS cPersonUuid, encounter_date, is_commencement, regimen_id AS regimenId, population_type As cPType,
             pregnant, hiv_test_result
         FROM
             prep_clinic
         WHERE
             archived = 0
           AND encounter_date BETWEEN :startDate AND :endDate
     ),
     prepInterrupt AS (
         SELECT
             person_uuid AS intPUuid, interruption_type AS intType
         FROM
             prep_interruption
         WHERE
             archived = 0 AND interruption_date <= :endDate
     ),

     prepEligible AS (
         SELECT
             person_uuid AS eligiblePUuid, target_group, population_type AS ptype, pregnancy_status AS ePreg
         FROM
             prep_eligibility
         WHERE
             archived = 0
           AND visit_date BETWEEN :startDate AND :endDate
     ),
     prepEligibleAll AS (
         SELECT
             person_uuid AS pUuid,  uuid AS eliPUuid, visit_type AS visitType
         FROM
             prep_eligibility
         WHERE
             archived = 0 AND visit_date <= :endDate
     ),

     prepEnroll AS (
         SELECT
             *
         FROM
             prep_enrollment
         WHERE
             archived = 0
           AND date_started BETWEEN :startDate AND :endDate
     ),

     AllData AS (
         SELECT
             pd.*,
             pc.*,
             pe.*,
             pel.*,
             pAll.*,
             pil.*
         FROM
             prepData pd
                 LEFT JOIN
             prepClinic pc ON pc.cPersonUuid = pd.personUuid
                 LEFT JOIN
             prepEnroll pe ON pe.person_uuid = pd.personUuid
                 LEFT JOIN
             prepEligible pel ON pel.eligiblePUuid = pd.personUuid
                 LEFT JOIN
             prepEligibleAll pAll ON pAll.pUuid = pd.personUuid
                 LEFT JOIN
             prepInterrupt pil ON pil.intPUuid = pd.personUuid

     )
SELECT
    '1' AS sno,
    'No. of individuals who were Screened for PrEP in the reporting month' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND eligiblePUuid IS NOT NULL AND age BETWEEN 15 AND 19 THEN personUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND eligiblePUuid IS NOT NULL AND age BETWEEN 20 AND 24 THEN personUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND eligiblePUuid IS NOT NULL AND age BETWEEN 25 AND 29 THEN personUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND eligiblePUuid IS NOT NULL AND age BETWEEN 30 AND 34 THEN personUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND eligiblePUuid IS NOT NULL AND age BETWEEN 35 AND 39 THEN personUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND eligiblePUuid IS NOT NULL AND age BETWEEN 40 AND 44 THEN personUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND eligiblePUuid IS NOT NULL AND age BETWEEN 45 AND 49 THEN personUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND eligiblePUuid IS NOT NULL AND age >= 50 THEN personUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND eligiblePUuid IS NOT NULL AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND eligiblePUuid IS NOT NULL  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND eligiblePUuid IS NOT NULL  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND eligiblePUuid IS NOT NULL  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND eligiblePUuid IS NOT NULL AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND eligiblePUuid IS NOT NULL AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND eligiblePUuid IS NOT NULL AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND eligiblePUuid IS NOT NULL  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT eligiblePUuid) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Serodiscordant Couples(SDC)' AS indicator,
 COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 15 AND 19 THEN personUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 20 AND 24 THEN personUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 25 AND 29 THEN personUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 30 AND 34 THEN personUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 35 AND 39 THEN personUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 40 AND 44 THEN personUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 45 AND 49 THEN personUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age >= 50 THEN personUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' THEN personUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Sex Workers' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 15 AND 19 THEN personUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 20 AND 24 THEN personUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 25 AND 29 THEN personUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 30 AND 34 THEN personUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN personUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN personUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN personUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age >= 50 THEN personUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SEX_WORKERS'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ptype ='POPULATION_TYPE_SEX_WORKERS' THEN personUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Partners of Sex workers' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 15 AND 19 THEN personUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 20 AND 24 THEN personUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 25 AND 29 THEN personUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 30 AND 34 THEN personUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN personUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN personUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN personUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age >= 50 THEN personUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' THEN personUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Injecting Drug Users' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 15 AND 19 THEN personUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 20 AND 24 THEN personUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 25 AND 29 THEN personUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 30 AND 34 THEN personUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 35 AND 39 THEN personUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 40 AND 44 THEN personUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 45 AND 49 THEN personUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age >= 50 THEN personUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' THEN personUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Individuals who engage in anal sex on a prolonged and regular basis' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 15 AND 19 THEN personUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 20 AND 24 THEN personUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 25 AND 29 THEN personUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 30 AND 34 THEN personUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 35 AND 39 THEN personUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 40 AND 44 THEN personUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 45 AND 49 THEN personUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age >= 50 THEN personUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' THEN personUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Exposed adolescents and young people' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 15 AND 19 THEN personUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 20 AND 24 THEN personUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 25 AND 29 THEN personUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 30 AND 34 THEN personUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 35 AND 39 THEN personUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 40 AND 44 THEN personUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 45 AND 49 THEN personUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age >= 50 THEN personUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' THEN personUuid END) AS total

FROM
    AllData
UNION ALL

SELECT
    '' AS sno,
    'Transgender' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 15 AND 19 THEN personUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 20 AND 24 THEN personUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 25 AND 29 THEN personUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 30 AND 34 THEN personUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 35 AND 39 THEN personUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 40 AND 44 THEN personUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 45 AND 49 THEN personUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age >= 50 THEN personUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_TRANSGENDER'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ptype ='POPULATION_TYPE_TRANSGENDER' THEN personUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Other population' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 15 AND 19 THEN personUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 20 AND 24 THEN personUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 25 AND 29 THEN personUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 30 AND 34 THEN personUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 35 AND 39 THEN personUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 40 AND 44 THEN personUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 45 AND 49 THEN personUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age >= 50 THEN personUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ptype ='POPULATION_TYPE_OTHER_POPULATION' THEN personUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Pregnant' AS indicator,
   NULL AS male19,
   NULL AS male24,
   NULL AS male29,
   NULL AS male34,
   NULL AS male39,
   NULL AS male44,
   NULL AS male49,
   NULL AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_PREGNANT'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_PREGNANT'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_PREGNANT'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_PREGNANT'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_PREGNANT' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_PREGNANT' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_PREGNANT' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_PREGNANT'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ePreg ='PREGANACY_STATUS_PREGNANT' THEN personUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Breastfeeding' AS indicator,
   NULL AS male19,
   NULL AS male24,
   NULL AS male29,
   NULL AS male34,
   NULL AS male39,
   NULL AS male44,
   NULL AS male49,
   NULL AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_BREASTFEEDING' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_BREASTFEEDING' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_BREASTFEEDING' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_BREASTFEEDING'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ePreg ='PREGANACY_STATUS_BREASTFEEDING' THEN personUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '2' AS sno,
    'No. of individuals who were eligible for PrEP in the reporting month' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND eligiblePUuid IS NOT NULL AND age BETWEEN 15 AND 19 THEN personUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND eligiblePUuid IS NOT NULL AND age BETWEEN 20 AND 24 THEN personUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND eligiblePUuid IS NOT NULL AND age BETWEEN 25 AND 29 THEN personUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND eligiblePUuid IS NOT NULL AND age BETWEEN 30 AND 34 THEN personUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND eligiblePUuid IS NOT NULL AND age BETWEEN 35 AND 39 THEN personUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND eligiblePUuid IS NOT NULL AND age BETWEEN 40 AND 44 THEN personUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND eligiblePUuid IS NOT NULL AND age BETWEEN 45 AND 49 THEN personUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND eligiblePUuid IS NOT NULL AND age >= 50 THEN personUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND eligiblePUuid IS NOT NULL AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND eligiblePUuid IS NOT NULL  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND eligiblePUuid IS NOT NULL  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND eligiblePUuid IS NOT NULL  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND eligiblePUuid IS NOT NULL AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND eligiblePUuid IS NOT NULL AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND eligiblePUuid IS NOT NULL AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND eligiblePUuid IS NOT NULL  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT eligiblePUuid) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Serodiscordant Couples(SDC)' AS indicator,
 COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 15 AND 19 THEN personUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 20 AND 24 THEN personUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 25 AND 29 THEN personUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 30 AND 34 THEN personUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 35 AND 39 THEN personUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 40 AND 44 THEN personUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 45 AND 49 THEN personUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age >= 50 THEN personUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' THEN personUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Sex Workers' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 15 AND 19 THEN personUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 20 AND 24 THEN personUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 25 AND 29 THEN personUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 30 AND 34 THEN personUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN personUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN personUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN personUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age >= 50 THEN personUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_SEX_WORKERS'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ptype ='POPULATION_TYPE_SEX_WORKERS' THEN personUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Partners of Sex workers' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 15 AND 19 THEN personUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 20 AND 24 THEN personUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 25 AND 29 THEN personUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 30 AND 34 THEN personUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN personUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN personUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN personUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age >= 50 THEN personUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' THEN personUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Injecting Drug Users' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 15 AND 19 THEN personUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 20 AND 24 THEN personUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 25 AND 29 THEN personUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 30 AND 34 THEN personUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 35 AND 39 THEN personUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 40 AND 44 THEN personUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 45 AND 49 THEN personUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age >= 50 THEN personUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' THEN personUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Individuals who engage in anal sex on a prolonged and regular basis' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 15 AND 19 THEN personUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 20 AND 24 THEN personUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 25 AND 29 THEN personUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 30 AND 34 THEN personUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 35 AND 39 THEN personUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 40 AND 44 THEN personUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 45 AND 49 THEN personUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age >= 50 THEN personUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' THEN personUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Exposed adolescents and young people' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 15 AND 19 THEN personUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 20 AND 24 THEN personUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 25 AND 29 THEN personUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 30 AND 34 THEN personUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 35 AND 39 THEN personUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 40 AND 44 THEN personUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 45 AND 49 THEN personUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age >= 50 THEN personUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' THEN personUuid END) AS total

FROM
    AllData
UNION ALL

SELECT
    '' AS sno,
    'Transgender' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 15 AND 19 THEN personUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 20 AND 24 THEN personUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 25 AND 29 THEN personUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 30 AND 34 THEN personUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 35 AND 39 THEN personUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 40 AND 44 THEN personUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 45 AND 49 THEN personUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age >= 50 THEN personUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_TRANSGENDER'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ptype ='POPULATION_TYPE_TRANSGENDER' THEN personUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Other population' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 15 AND 19 THEN personUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 20 AND 24 THEN personUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 25 AND 29 THEN personUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 30 AND 34 THEN personUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 35 AND 39 THEN personUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 40 AND 44 THEN personUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 45 AND 49 THEN personUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age >= 50 THEN personUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ptype ='POPULATION_TYPE_OTHER_POPULATION' THEN personUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Pregnant' AS indicator,
   NULL AS male19,
   NULL AS male24,
   NULL AS male29,
   NULL AS male34,
   NULL AS male39,
   NULL AS male44,
   NULL AS male49,
   NULL AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_PREGNANT'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_PREGNANT'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_PREGNANT'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_PREGNANT'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_PREGNANT' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_PREGNANT' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_PREGNANT' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_PREGNANT'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ePreg ='PREGANACY_STATUS_PREGNANT' THEN personUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Breastfeeding' AS indicator,
   NULL AS male19,
   NULL AS male24,
   NULL AS male29,
   NULL AS male34,
   NULL AS male39,
   NULL AS male44,
   NULL AS male49,
   NULL AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 15 AND 19 THEN personUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 20 AND 24 THEN personUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 25 AND 29 THEN personUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 30 AND 34 THEN personUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_BREASTFEEDING' AND age BETWEEN 35 AND 39 THEN personUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_BREASTFEEDING' AND age BETWEEN 40 AND 44 THEN personUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_BREASTFEEDING' AND age BETWEEN 45 AND 49 THEN personUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND ePreg ='PREGANACY_STATUS_BREASTFEEDING'  AND age >= 50 THEN personUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN ePreg ='PREGANACY_STATUS_BREASTFEEDING' THEN personUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '3' AS sno,
    'No. of individuals who accepted to commence PrEP in the reporting month' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = true AND  cPersonUuid IS NOT NULL  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = true AND cPersonUuid IS NOT NULL  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = true AND cPersonUuid IS NOT NULL  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = true AND cPersonUuid IS NOT NULL  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Serodiscordant Couples(SDC)' AS indicator,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Sex Workers' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  cptype ='POPULATION_TYPE_SEX_WORKERS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Partners of Sex workers' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Injecting Drug Users' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Individuals who engage in anal sex on a prolonged and regular basis' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Exposed adolescents and young people' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' THEN cPersonUuid END) AS total

FROM
    AllData
UNION ALL

SELECT
    '' AS sno,
    'Transgender' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  cptype ='POPULATION_TYPE_TRANSGENDER' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Other population' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  cptype ='POPULATION_TYPE_OTHER_POPULATION' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Pregnant' AS indicator,
   NULL AS male19,
   NULL AS male24,
   NULL AS male29,
   NULL AS male34,
   NULL AS male39,
   NULL AS male44,
   NULL AS male49,
   NULL AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true') AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true') AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true') AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND sex = 'Female' AND  (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true') THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Breastfeeding' AS indicator,
   NULL AS male19,
   NULL AS male24,
   NULL AS male29,
   NULL AS male34,
   NULL AS male39,
   NULL AS male44,
   NULL AS male49,
   NULL AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND sex = 'Female' AND  pregnant ='PREGANACY_STATUS_BREASTFEEDING' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '4' AS sno,
    'No. of individuals who were newly initiated on PrEP in the reporting month' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = true AND  cPersonUuid IS NOT NULL  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = true AND cPersonUuid IS NOT NULL  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = true AND cPersonUuid IS NOT NULL  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = true AND cPersonUuid IS NOT NULL AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = true AND cPersonUuid IS NOT NULL  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Serodiscordant Couples(SDC)' AS indicator,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Sex Workers' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  cptype ='POPULATION_TYPE_SEX_WORKERS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Partners of Sex workers' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Injecting Drug Users' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Individuals who engage in anal sex on a prolonged and regular basis' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Exposed adolescents and young people' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' THEN cPersonUuid END) AS total

FROM
    AllData
UNION ALL

SELECT
    '' AS sno,
    'Transgender' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  cptype ='POPULATION_TYPE_TRANSGENDER' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Other population' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  cptype ='POPULATION_TYPE_OTHER_POPULATION' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Pregnant' AS indicator,
   NULL AS male19,
   NULL AS male24,
   NULL AS male29,
   NULL AS male34,
   NULL AS male39,
   NULL AS male44,
   NULL AS male49,
   NULL AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true') AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true') AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true') AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND sex = 'Female' AND  (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true') THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Breastfeeding' AS indicator,
   NULL AS male19,
   NULL AS male24,
   NULL AS male29,
   NULL AS male34,
   NULL AS male39,
   NULL AS male44,
   NULL AS male49,
   NULL AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'PrEP Type Oral' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 1 AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 1  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 1  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 1  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 1  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 1 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 1 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 1 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 1  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  regimenId = 1 THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'PrEP Type ED PrEP' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 3 AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 3  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 3  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 3  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 3  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 3 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 3 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 3 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 3  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  regimenId = 3 THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'PrEP Type Injectable' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 2 AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 2  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 2  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 2  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 2  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 2 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 2 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 2 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 2  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  regimenId = 2 THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'PrEP Type Ring' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Male' AND regimenId = 4 AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 4  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 4  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 4  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 4  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 4 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 4 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 4 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = true AND  sex = 'Female' AND regimenId = 4  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = true AND  regimenId = 4 THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '5' AS sno,
    'Number of individuals who received PrEP in the reporting month' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = false AND cPersonUuid IS NOT NULL AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = false AND cPersonUuid IS NOT NULL AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = false AND cPersonUuid IS NOT NULL AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = false AND cPersonUuid IS NOT NULL AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = false AND cPersonUuid IS NOT NULL AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = false AND cPersonUuid IS NOT NULL AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = false AND cPersonUuid IS NOT NULL AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND is_commencement = false AND cPersonUuid IS NOT NULL AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = false AND cPersonUuid IS NOT NULL AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = false AND  cPersonUuid IS NOT NULL  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = false AND cPersonUuid IS NOT NULL  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = false AND cPersonUuid IS NOT NULL  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = false AND cPersonUuid IS NOT NULL AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = false AND cPersonUuid IS NOT NULL AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = false AND cPersonUuid IS NOT NULL AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND is_commencement = false AND cPersonUuid IS NOT NULL  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = false THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Serodiscordant Couples(SDC)' AS indicator,
 COUNT(DISTINCT CASE WHEN is_commencement = false AND  is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = false AND  cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Sex Workers' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = false AND  cptype ='POPULATION_TYPE_SEX_WORKERS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Partners of Sex workers' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = false AND  cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Injecting Drug Users' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = false AND  cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Individuals who engage in anal sex on a prolonged and regular basis' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = false AND  cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Exposed adolescents and young people' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = false AND  cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' THEN cPersonUuid END) AS total

FROM
    AllData
UNION ALL

SELECT
    '' AS sno,
    'Transgender' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = false AND  cptype ='POPULATION_TYPE_TRANSGENDER' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Other population' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = false AND  cptype ='POPULATION_TYPE_OTHER_POPULATION' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Pregnant' AS indicator,
   NULL AS male19,
   NULL AS male24,
   NULL AS male29,
   NULL AS male34,
   NULL AS male39,
   NULL AS male44,
   NULL AS male49,
   NULL AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true') AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true') AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true') AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = false AND sex = 'Female' AND  (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true') THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Breastfeeding' AS indicator,
   NULL AS male19,
   NULL AS male24,
   NULL AS male29,
   NULL AS male34,
   NULL AS male39,
   NULL AS male44,
   NULL AS male49,
   NULL AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = false AND sex = 'Female' AND  pregnant ='PREGANACY_STATUS_BREASTFEEDING' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'PrEP Type Oral' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 1 AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 1  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 1  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 1  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 1  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 1 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 1 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 1 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 1  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = false AND  regimenId = 1 THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'PrEP Type ED PrEP' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 3 AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 3  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 3  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 3  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 3  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 3 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 3 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 3 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 3  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = false AND  regimenId = 3 THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'PrEP Type Injectable' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 2 AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 2  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 2  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 2  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 2  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 2 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 2 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 2 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 2  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = false AND  regimenId = 2 THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'PrEP Type Ring' AS indicator,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Male' AND regimenId = 4 AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 4  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 4  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 4  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 4  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 4 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 4 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 4 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN is_commencement = false AND  sex = 'Female' AND regimenId = 4  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN is_commencement = false AND  regimenId = 4 THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '6' AS sno,
    'Total Number of PrEP Visit' AS indicator,
 COUNT(DISTINCT CASE WHEN sex = 'Male'  AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND age >= 50 THEN eliPUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND age >= 50 THEN eliPUuid END) AS female50,
 COUNT(DISTINCT eliPUuid) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Initiation' AS indicator,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_INITIATION' AND  sex = 'Male' AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_INITIATION' AND  sex = 'Male' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_INITIATION' AND  sex = 'Male' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_INITIATION' AND  sex = 'Male' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_INITIATION' AND  sex = 'Male' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_INITIATION' AND  sex = 'Male' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_INITIATION' AND  sex = 'Male' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_INITIATION' AND  sex = 'Male' AND age >= 50 THEN eliPUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_INITIATION' AND  sex = 'Female' AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_INITIATION' AND  sex = 'Female' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_INITIATION' AND  sex = 'Female' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_INITIATION' AND  sex = 'Female' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_INITIATION' AND  sex = 'Female' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_INITIATION' AND  sex = 'Female' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_INITIATION' AND  sex = 'Female' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_INITIATION' AND  sex = 'Female' AND age >= 50 THEN eliPUuid END) AS female50,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_INITIATION' THEN eliPUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Second Initiation' AS indicator,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_SECOND_INITIATION' AND  sex = 'Male' AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_SECOND_INITIATION' AND  sex = 'Male' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_SECOND_INITIATION' AND  sex = 'Male' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_SECOND_INITIATION' AND  sex = 'Male' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_SECOND_INITIATION' AND  sex = 'Male' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_SECOND_INITIATION' AND  sex = 'Male' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_SECOND_INITIATION' AND  sex = 'Male' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_SECOND_INITIATION' AND  sex = 'Male' AND age >= 50 THEN eliPUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_SECOND_INITIATION' AND  sex = 'Female' AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_SECOND_INITIATION' AND  sex = 'Female' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_SECOND_INITIATION' AND  sex = 'Female' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_SECOND_INITIATION' AND  sex = 'Female' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_SECOND_INITIATION' AND  sex = 'Female' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_SECOND_INITIATION' AND  sex = 'Female' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_SECOND_INITIATION' AND  sex = 'Female' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_SECOND_INITIATION' AND  sex = 'Female' AND age >= 50 THEN eliPUuid END) AS female50,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_SECOND_INITIATION' THEN eliPUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Refill / Re-Injection' AS indicator,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_REFILL_RE-INJECTION' AND  sex = 'Male' AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_REFILL_RE-INJECTION' AND  sex = 'Male' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_REFILL_RE-INJECTION' AND  sex = 'Male' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_REFILL_RE-INJECTION' AND  sex = 'Male' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_REFILL_RE-INJECTION' AND  sex = 'Male' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_REFILL_RE-INJECTION' AND  sex = 'Male' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_REFILL_RE-INJECTION' AND  sex = 'Male' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_REFILL_RE-INJECTION' AND  sex = 'Male' AND age >= 50 THEN eliPUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_REFILL_RE-INJECTION' AND  sex = 'Female' AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_REFILL_RE-INJECTION' AND  sex = 'Female' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_REFILL_RE-INJECTION' AND  sex = 'Female' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_REFILL_RE-INJECTION' AND  sex = 'Female' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_REFILL_RE-INJECTION' AND  sex = 'Female' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_REFILL_RE-INJECTION' AND  sex = 'Female' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_REFILL_RE-INJECTION' AND  sex = 'Female' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_REFILL_RE-INJECTION' AND  sex = 'Female' AND age >= 50 THEN eliPUuid END) AS female50,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_REFILL_RE-INJECTION' THEN eliPUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Method Switch' AS indicator,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_METHOD_SWITCH' AND  sex = 'Male' AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_METHOD_SWITCH' AND  sex = 'Male' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_METHOD_SWITCH' AND  sex = 'Male' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_METHOD_SWITCH' AND  sex = 'Male' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_METHOD_SWITCH' AND  sex = 'Male' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_METHOD_SWITCH' AND  sex = 'Male' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_METHOD_SWITCH' AND  sex = 'Male' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_METHOD_SWITCH' AND  sex = 'Male' AND age >= 50 THEN eliPUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_METHOD_SWITCH' AND  sex = 'Female' AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_METHOD_SWITCH' AND  sex = 'Female' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_METHOD_SWITCH' AND  sex = 'Female' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_METHOD_SWITCH' AND  sex = 'Female' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_METHOD_SWITCH' AND  sex = 'Female' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_METHOD_SWITCH' AND  sex = 'Female' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_METHOD_SWITCH' AND  sex = 'Female' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_METHOD_SWITCH' AND  sex = 'Female' AND age >= 50 THEN eliPUuid END) AS female50,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_METHOD_SWITCH' THEN eliPUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Restart' AS indicator,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_RESTART' AND  sex = 'Male' AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_RESTART' AND  sex = 'Male' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_RESTART' AND  sex = 'Male' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_RESTART' AND  sex = 'Male' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_RESTART' AND  sex = 'Male' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_RESTART' AND  sex = 'Male' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_RESTART' AND  sex = 'Male' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_RESTART' AND  sex = 'Male' AND age >= 50 THEN eliPUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_RESTART' AND  sex = 'Female' AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_RESTART' AND  sex = 'Female' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_RESTART' AND  sex = 'Female' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_RESTART' AND  sex = 'Female' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_RESTART' AND  sex = 'Female' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_RESTART' AND  sex = 'Female' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_RESTART' AND  sex = 'Female' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_RESTART' AND  sex = 'Female' AND age >= 50 THEN eliPUuid END) AS female50,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_RESTART' THEN eliPUuid END) AS total

FROM
    AllData
UNION ALL
SELECT
    '' AS sno,
    'Transfer In' AS indicator,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_TRANSFER_IN' AND  sex = 'Male' AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_TRANSFER_IN' AND  sex = 'Male' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_TRANSFER_IN' AND  sex = 'Male' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_TRANSFER_IN' AND  sex = 'Male' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_TRANSFER_IN' AND  sex = 'Male' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_TRANSFER_IN' AND  sex = 'Male' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_TRANSFER_IN' AND  sex = 'Male' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_TRANSFER_IN' AND  sex = 'Male' AND age >= 50 THEN eliPUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_TRANSFER_IN' AND  sex = 'Female' AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_TRANSFER_IN' AND  sex = 'Female' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_TRANSFER_IN' AND  sex = 'Female' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_TRANSFER_IN' AND  sex = 'Female' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_TRANSFER_IN' AND  sex = 'Female' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_TRANSFER_IN' AND  sex = 'Female' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_TRANSFER_IN' AND  sex = 'Female' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_TRANSFER_IN' AND  sex = 'Female' AND age >= 50 THEN eliPUuid END) AS female50,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_TRANSFER_IN' THEN eliPUuid END) AS total

FROM
    AllData
UNION ALL
SELECT
    '' AS sno,
    'No PrEP Provided' AS indicator,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_NO_PREP_PROVIDED' AND  sex = 'Male' AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_NO_PREP_PROVIDED' AND  sex = 'Male' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_NO_PREP_PROVIDED' AND  sex = 'Male' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_NO_PREP_PROVIDED' AND  sex = 'Male' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_NO_PREP_PROVIDED' AND  sex = 'Male' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_NO_PREP_PROVIDED' AND  sex = 'Male' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_NO_PREP_PROVIDED' AND  sex = 'Male' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_NO_PREP_PROVIDED' AND  sex = 'Male' AND age >= 50 THEN eliPUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_NO_PREP_PROVIDED' AND  sex = 'Female' AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_NO_PREP_PROVIDED' AND  sex = 'Female' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_NO_PREP_PROVIDED' AND  sex = 'Female' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_NO_PREP_PROVIDED' AND  sex = 'Female' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_NO_PREP_PROVIDED' AND  sex = 'Female' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_NO_PREP_PROVIDED' AND  sex = 'Female' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_NO_PREP_PROVIDED' AND  sex = 'Female' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_NO_PREP_PROVIDED' AND  sex = 'Female' AND age >= 50 THEN eliPUuid END) AS female50,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_NO_PREP_PROVIDED' THEN eliPUuid END) AS total

FROM
    AllData
UNION ALL
SELECT
    '' AS sno,
    'Discontinuation' AS indicator,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION' AND  sex = 'Male' AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION' AND  sex = 'Male' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION' AND  sex = 'Male' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION' AND  sex = 'Male' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION' AND  sex = 'Male' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION' AND  sex = 'Male' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION' AND  sex = 'Male' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION' AND  sex = 'Male' AND age >= 50 THEN eliPUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION' AND  sex = 'Female' AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION' AND  sex = 'Female' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION' AND  sex = 'Female' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION' AND  sex = 'Female' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION' AND  sex = 'Female' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION' AND  sex = 'Female' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION' AND  sex = 'Female' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION' AND  sex = 'Female' AND age >= 50 THEN eliPUuid END) AS female50,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION' THEN eliPUuid END) AS total

FROM
    AllData
UNION ALL

SELECT
    '' AS sno,
    'Discontinuation Follow-up' AS indicator,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION_FOLLOW-UP' AND  sex = 'Male' AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION_FOLLOW-UP' AND  sex = 'Male' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION_FOLLOW-UP' AND  sex = 'Male' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION_FOLLOW-UP' AND  sex = 'Male' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION_FOLLOW-UP' AND  sex = 'Male' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION_FOLLOW-UP' AND  sex = 'Male' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION_FOLLOW-UP' AND  sex = 'Male' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION_FOLLOW-UP' AND  sex = 'Male' AND age >= 50 THEN eliPUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION_FOLLOW-UP' AND  sex = 'Female' AND age BETWEEN 15 AND 19 THEN eliPUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION_FOLLOW-UP' AND  sex = 'Female' AND age BETWEEN 20 AND 24 THEN eliPUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION_FOLLOW-UP' AND  sex = 'Female' AND age BETWEEN 25 AND 29 THEN eliPUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION_FOLLOW-UP' AND  sex = 'Female' AND age BETWEEN 30 AND 34 THEN eliPUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION_FOLLOW-UP' AND  sex = 'Female' AND age BETWEEN 35 AND 39 THEN eliPUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION_FOLLOW-UP' AND  sex = 'Female' AND age BETWEEN 40 AND 44 THEN eliPUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION_FOLLOW-UP' AND  sex = 'Female' AND age BETWEEN 45 AND 49 THEN eliPUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION_FOLLOW-UP' AND  sex = 'Female' AND age >= 50 THEN eliPUuid END) AS female50,
  COUNT(DISTINCT CASE WHEN visitType = 'PREP_VISIT_TYPE_DISCONTINUATION_FOLLOW-UP' THEN eliPUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '7' AS sno,
    'No. of individuals returning for PrEP who received repeat HIV testing in the reporting month' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND cPersonUuid IS NOT NULL AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND cPersonUuid IS NOT NULL AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND cPersonUuid IS NOT NULL AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  cPersonUuid IS NOT NULL AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND cPersonUuid IS NOT NULL AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND cPersonUuid IS NOT NULL AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND cPersonUuid IS NOT NULL AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND cPersonUuid IS NOT NULL AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND cPersonUuid IS NOT NULL AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  cPersonUuid IS NOT NULL  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND cPersonUuid IS NOT NULL  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND cPersonUuid IS NOT NULL  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND cPersonUuid IS NOT NULL AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND cPersonUuid IS NOT NULL AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND cPersonUuid IS NOT NULL AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND cPersonUuid IS NOT NULL  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'HIV Negative' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND cPersonUuid IS NOT NULL AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  cPersonUuid IS NOT NULL  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND cPersonUuid IS NOT NULL  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND cPersonUuid IS NOT NULL  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND cPersonUuid IS NOT NULL  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Serodiscordant Couples(SDC)' AS indicator,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE'  AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Sex Workers' AS indicator,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  cptype ='POPULATION_TYPE_SEX_WORKERS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Partners of Sex workers' AS indicator,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Injecting Drug Users' AS indicator,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Individuals who engage in anal sex on a prolonged and regular basis' AS indicator,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Exposed adolescents and young people' AS indicator,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' THEN cPersonUuid END) AS total

FROM
    AllData
UNION ALL

SELECT
    '' AS sno,
    'Transgender' AS indicator,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  cptype ='POPULATION_TYPE_TRANSGENDER' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Other population' AS indicator,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_NEGATIVE' AND  cptype ='POPULATION_TYPE_OTHER_POPULATION' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'HIV Positive' AS indicator,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND cPersonUuid IS NOT NULL AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  cPersonUuid IS NOT NULL  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND cPersonUuid IS NOT NULL  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND cPersonUuid IS NOT NULL  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND cPersonUuid IS NOT NULL AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND cPersonUuid IS NOT NULL  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Serodiscordant Couples(SDC)' AS indicator,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE'  AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  cptype ='POPULATION_TYPE_SERODISCORDANT_COUPLES_(SDC)' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Sex Workers' AS indicator,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_SEX_WORKERS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  cptype ='POPULATION_TYPE_SEX_WORKERS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Partners of Sex workers' AS indicator,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  cptype ='POPULATION_TYPE_PARTNERS_OF_SEX_WORKERS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Injecting Drug Users' AS indicator,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  cptype ='POPULATION_TYPE_INJECTING_DRUG_USERS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Individuals who engage in anal sex on a prolonged and regular basis' AS indicator,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  cptype ='POPULATION_TYPE_INDIVIDUALS_WHO_ENGAGE_IN_ANAL_SEX_ON_A_PROLONGED_AND_REGULAR_BASIS' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Exposed adolescents and young people' AS indicator,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  cptype ='POPULATION_TYPE_EXPOSED_ADOLESCENTS_AND_YOUNG_PEOPLE' THEN cPersonUuid END) AS total

FROM
    AllData
UNION ALL

SELECT
    '' AS sno,
    'Transgender' AS indicator,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_TRANSGENDER'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  cptype ='POPULATION_TYPE_TRANSGENDER' THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'Other population' AS indicator,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Male' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  sex = 'Female' AND cptype ='POPULATION_TYPE_OTHER_POPULATION'  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result = 'HIV_TEST_RESULT_POSITIVE' AND  cptype ='POPULATION_TYPE_OTHER_POPULATION' THEN cPersonUuid END) AS total

FROM
    AllData
UNION ALL

SELECT
    '' AS sno,
    'Pregnant' AS indicator,
   NULL AS male19,
   NULL AS male24,
   NULL AS male29,
   NULL AS male34,
   NULL AS male39,
   NULL AS male44,
   NULL AS male49,
   NULL AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true') AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true') AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true') AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true')  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND sex = 'Female' AND (pregnant ='PREGANACY_STATUS_PREGNANT' OR pregnant = 'true') THEN cPersonUuid END) AS total

FROM
    AllData
UNION ALL

SELECT
    '' AS sno,
    'Breastfeeding' AS indicator,
   NULL AS male19,
   NULL AS male24,
   NULL AS male29,
   NULL AS male34,
   NULL AS male39,
   NULL AS male44,
   NULL AS male49,
   NULL AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING' AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING' AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING' AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND pregnant ='PREGANACY_STATUS_BREASTFEEDING'  AND age >= 50 THEN cPersonUuid END) AS female50,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  pregnant ='PREGANACY_STATUS_BREASTFEEDING' AND sex = 'Female' THEN cPersonUuid END) AS total

FROM
    AllData
UNION ALL

SELECT
    '' AS sno,
    'PrEP Type Oral' AS indicator,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 1 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 1 AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 1  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 1  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 1  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 1  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 1 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 1 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 1 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 1  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  regimenId = 1 THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'PrEP Type ED PrEP' AS indicator,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 3 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 3 AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 3  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 3  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 3  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 3  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 3 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 3 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 3 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 3  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  regimenId = 3 THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'PrEP Type Injectable' AS indicator,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 2 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 2 AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 2  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 2  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 2  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 2  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 2 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 2 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 2 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 2  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  regimenId = 2 THEN cPersonUuid END) AS total

FROM
    AllData

UNION ALL

SELECT
    '' AS sno,
    'PrEP Type Ring' AS indicator,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 4 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Male' AND regimenId = 4 AND age >= 50 THEN cPersonUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 4  AND age BETWEEN 15 AND 19 THEN cPersonUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 4  AND age BETWEEN 20 AND 24 THEN cPersonUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 4  AND age BETWEEN 25 AND 29 THEN cPersonUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 4  AND age BETWEEN 30 AND 34 THEN cPersonUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 4 AND age BETWEEN 35 AND 39 THEN cPersonUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 4 AND age BETWEEN 40 AND 44 THEN cPersonUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 4 AND age BETWEEN 45 AND 49 THEN cPersonUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  sex = 'Female' AND regimenId = 4  AND age >= 50 THEN cPersonUuid END) AS female50,
 COUNT(DISTINCT CASE WHEN hiv_test_result IS NOT NULL AND hiv_test_result != 'NOT DONE' AND  regimenId = 4 THEN cPersonUuid END) AS total

FROM
    AllData
UNION ALL

SELECT
    '8' AS sno,
    'Number of individuals who discontinued PrEP' AS indicator,
 COUNT(DISTINCT CASE WHEN sex = 'Male'  AND age BETWEEN 15 AND 19 THEN intPUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND age BETWEEN 20 AND 24 THEN intPUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND age BETWEEN 25 AND 29 THEN intPUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND age BETWEEN 30 AND 34 THEN intPUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND age BETWEEN 35 AND 39 THEN intPUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND age BETWEEN 40 AND 44 THEN intPUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND age BETWEEN 45 AND 49 THEN intPUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN sex = 'Male' AND age >= 50 THEN intPUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 15 AND 19 THEN intPUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 20 AND 24 THEN intPUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 25 AND 29 THEN intPUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 30 AND 34 THEN intPUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 35 AND 39 THEN intPUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 40 AND 44 THEN intPUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 45 AND 49 THEN intPUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN sex = 'Female' AND age >= 50 THEN intPUuid END) AS female50,
 COUNT(DISTINCT intPUuid) AS total

FROM
    AllData
UNION ALL

SELECT
    '' AS sno,
    'Adverse drug reaction' AS indicator,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_ADVERSE_DRUG_REACTION' AND  sex = 'Male' AND age BETWEEN 15 AND 19 THEN intPUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_ADVERSE_DRUG_REACTION' AND  sex = 'Male' AND age BETWEEN 20 AND 24 THEN intPUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_ADVERSE_DRUG_REACTION' AND  sex = 'Male' AND age BETWEEN 25 AND 29 THEN intPUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_ADVERSE_DRUG_REACTION' AND  sex = 'Male' AND age BETWEEN 30 AND 34 THEN intPUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_ADVERSE_DRUG_REACTION' AND  sex = 'Male' AND age BETWEEN 35 AND 39 THEN intPUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_ADVERSE_DRUG_REACTION' AND  sex = 'Male' AND age BETWEEN 40 AND 44 THEN intPUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_ADVERSE_DRUG_REACTION' AND  sex = 'Male' AND age BETWEEN 45 AND 49 THEN intPUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_ADVERSE_DRUG_REACTION' AND  sex = 'Male' AND age >= 50 THEN intPUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_ADVERSE_DRUG_REACTION' AND  sex = 'Female' AND age BETWEEN 15 AND 19 THEN intPUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_ADVERSE_DRUG_REACTION' AND  sex = 'Female' AND age BETWEEN 20 AND 24 THEN intPUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_ADVERSE_DRUG_REACTION' AND  sex = 'Female' AND age BETWEEN 25 AND 29 THEN intPUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_ADVERSE_DRUG_REACTION' AND  sex = 'Female' AND age BETWEEN 30 AND 34 THEN intPUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_ADVERSE_DRUG_REACTION' AND  sex = 'Female' AND age BETWEEN 35 AND 39 THEN intPUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_ADVERSE_DRUG_REACTION' AND  sex = 'Female' AND age BETWEEN 40 AND 44 THEN intPUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_ADVERSE_DRUG_REACTION' AND  sex = 'Female' AND age BETWEEN 45 AND 49 THEN intPUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_ADVERSE_DRUG_REACTION' AND  sex = 'Female' AND age >= 50 THEN intPUuid END) AS female50,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_ADVERSE_DRUG_REACTION' THEN intPUuid END) AS total

FROM
    AllData
UNION ALL

SELECT
    '' AS sno,
    'Dead' AS indicator,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_DEAD' AND  sex = 'Male' AND age BETWEEN 15 AND 19 THEN intPUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_DEAD' AND  sex = 'Male' AND age BETWEEN 20 AND 24 THEN intPUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_DEAD' AND  sex = 'Male' AND age BETWEEN 25 AND 29 THEN intPUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_DEAD' AND  sex = 'Male' AND age BETWEEN 30 AND 34 THEN intPUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_DEAD' AND  sex = 'Male' AND age BETWEEN 35 AND 39 THEN intPUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_DEAD' AND  sex = 'Male' AND age BETWEEN 40 AND 44 THEN intPUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_DEAD' AND  sex = 'Male' AND age BETWEEN 45 AND 49 THEN intPUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_DEAD' AND  sex = 'Male' AND age >= 50 THEN intPUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_DEAD' AND  sex = 'Female' AND age BETWEEN 15 AND 19 THEN intPUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_DEAD' AND  sex = 'Female' AND age BETWEEN 20 AND 24 THEN intPUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_DEAD' AND  sex = 'Female' AND age BETWEEN 25 AND 29 THEN intPUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_DEAD' AND  sex = 'Female' AND age BETWEEN 30 AND 34 THEN intPUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_DEAD' AND  sex = 'Female' AND age BETWEEN 35 AND 39 THEN intPUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_DEAD' AND  sex = 'Female' AND age BETWEEN 40 AND 44 THEN intPUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_DEAD' AND  sex = 'Female' AND age BETWEEN 45 AND 49 THEN intPUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_DEAD' AND  sex = 'Female' AND age >= 50 THEN intPUuid END) AS female50,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_DEAD' THEN intPUuid END) AS total

FROM
    AllData
UNION ALL

SELECT
    '' AS sno,
    'Loss to follow up' AS indicator,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_LOSS_TO_FOLLOW_UP' AND  sex = 'Male' AND age BETWEEN 15 AND 19 THEN intPUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_LOSS_TO_FOLLOW_UP' AND  sex = 'Male' AND age BETWEEN 20 AND 24 THEN intPUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_LOSS_TO_FOLLOW_UP' AND  sex = 'Male' AND age BETWEEN 25 AND 29 THEN intPUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_LOSS_TO_FOLLOW_UP' AND  sex = 'Male' AND age BETWEEN 30 AND 34 THEN intPUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_LOSS_TO_FOLLOW_UP' AND  sex = 'Male' AND age BETWEEN 35 AND 39 THEN intPUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_LOSS_TO_FOLLOW_UP' AND  sex = 'Male' AND age BETWEEN 40 AND 44 THEN intPUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_LOSS_TO_FOLLOW_UP' AND  sex = 'Male' AND age BETWEEN 45 AND 49 THEN intPUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_LOSS_TO_FOLLOW_UP' AND  sex = 'Male' AND age >= 50 THEN intPUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_LOSS_TO_FOLLOW_UP' AND  sex = 'Female' AND age BETWEEN 15 AND 19 THEN intPUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_LOSS_TO_FOLLOW_UP' AND  sex = 'Female' AND age BETWEEN 20 AND 24 THEN intPUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_LOSS_TO_FOLLOW_UP' AND  sex = 'Female' AND age BETWEEN 25 AND 29 THEN intPUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_LOSS_TO_FOLLOW_UP' AND  sex = 'Female' AND age BETWEEN 30 AND 34 THEN intPUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_LOSS_TO_FOLLOW_UP' AND  sex = 'Female' AND age BETWEEN 35 AND 39 THEN intPUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_LOSS_TO_FOLLOW_UP' AND  sex = 'Female' AND age BETWEEN 40 AND 44 THEN intPUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_LOSS_TO_FOLLOW_UP' AND  sex = 'Female' AND age BETWEEN 45 AND 49 THEN intPUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_LOSS_TO_FOLLOW_UP' AND  sex = 'Female' AND age >= 50 THEN intPUuid END) AS female50,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_LOSS_TO_FOLLOW_UP' THEN intPUuid END) AS total

FROM
    AllData
UNION ALL

SELECT
    '' AS sno,
    'Restart' AS indicator,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_RESTART' AND  sex = 'Male' AND age BETWEEN 15 AND 19 THEN intPUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_RESTART' AND  sex = 'Male' AND age BETWEEN 20 AND 24 THEN intPUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_RESTART' AND  sex = 'Male' AND age BETWEEN 25 AND 29 THEN intPUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_RESTART' AND  sex = 'Male' AND age BETWEEN 30 AND 34 THEN intPUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_RESTART' AND  sex = 'Male' AND age BETWEEN 35 AND 39 THEN intPUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_RESTART' AND  sex = 'Male' AND age BETWEEN 40 AND 44 THEN intPUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_RESTART' AND  sex = 'Male' AND age BETWEEN 45 AND 49 THEN intPUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_RESTART' AND  sex = 'Male' AND age >= 50 THEN intPUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_RESTART' AND  sex = 'Female' AND age BETWEEN 15 AND 19 THEN intPUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_RESTART' AND  sex = 'Female' AND age BETWEEN 20 AND 24 THEN intPUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_RESTART' AND  sex = 'Female' AND age BETWEEN 25 AND 29 THEN intPUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_RESTART' AND  sex = 'Female' AND age BETWEEN 30 AND 34 THEN intPUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_RESTART' AND  sex = 'Female' AND age BETWEEN 35 AND 39 THEN intPUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_RESTART' AND  sex = 'Female' AND age BETWEEN 40 AND 44 THEN intPUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_RESTART' AND  sex = 'Female' AND age BETWEEN 45 AND 49 THEN intPUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_RESTART' AND  sex = 'Female' AND age >= 50 THEN intPUuid END) AS female50,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_RESTART' THEN intPUuid END) AS total

FROM
    AllData
UNION ALL

SELECT
    '' AS sno,
    'Seroconverted' AS indicator,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_SEROCONVERTED' AND  sex = 'Male' AND age BETWEEN 15 AND 19 THEN intPUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_SEROCONVERTED' AND  sex = 'Male' AND age BETWEEN 20 AND 24 THEN intPUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_SEROCONVERTED' AND  sex = 'Male' AND age BETWEEN 25 AND 29 THEN intPUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_SEROCONVERTED' AND  sex = 'Male' AND age BETWEEN 30 AND 34 THEN intPUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_SEROCONVERTED' AND  sex = 'Male' AND age BETWEEN 35 AND 39 THEN intPUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_SEROCONVERTED' AND  sex = 'Male' AND age BETWEEN 40 AND 44 THEN intPUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_SEROCONVERTED' AND  sex = 'Male' AND age BETWEEN 45 AND 49 THEN intPUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_SEROCONVERTED' AND  sex = 'Male' AND age >= 50 THEN intPUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_SEROCONVERTED' AND  sex = 'Female' AND age BETWEEN 15 AND 19 THEN intPUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_SEROCONVERTED' AND  sex = 'Female' AND age BETWEEN 20 AND 24 THEN intPUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_SEROCONVERTED' AND  sex = 'Female' AND age BETWEEN 25 AND 29 THEN intPUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_SEROCONVERTED' AND  sex = 'Female' AND age BETWEEN 30 AND 34 THEN intPUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_SEROCONVERTED' AND  sex = 'Female' AND age BETWEEN 35 AND 39 THEN intPUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_SEROCONVERTED' AND  sex = 'Female' AND age BETWEEN 40 AND 44 THEN intPUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_SEROCONVERTED' AND  sex = 'Female' AND age BETWEEN 45 AND 49 THEN intPUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_SEROCONVERTED' AND  sex = 'Female' AND age >= 50 THEN intPUuid END) AS female50,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_SEROCONVERTED' THEN intPUuid END) AS total

FROM
    AllData
UNION ALL

SELECT
    '' AS sno,
    'Stopped' AS indicator,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_STOPPED' AND  sex = 'Male' AND age BETWEEN 15 AND 19 THEN intPUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_STOPPED' AND  sex = 'Male' AND age BETWEEN 20 AND 24 THEN intPUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_STOPPED' AND  sex = 'Male' AND age BETWEEN 25 AND 29 THEN intPUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_STOPPED' AND  sex = 'Male' AND age BETWEEN 30 AND 34 THEN intPUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_STOPPED' AND  sex = 'Male' AND age BETWEEN 35 AND 39 THEN intPUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_STOPPED' AND  sex = 'Male' AND age BETWEEN 40 AND 44 THEN intPUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_STOPPED' AND  sex = 'Male' AND age BETWEEN 45 AND 49 THEN intPUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_STOPPED' AND  sex = 'Male' AND age >= 50 THEN intPUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_STOPPED' AND  sex = 'Female' AND age BETWEEN 15 AND 19 THEN intPUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_STOPPED' AND  sex = 'Female' AND age BETWEEN 20 AND 24 THEN intPUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_STOPPED' AND  sex = 'Female' AND age BETWEEN 25 AND 29 THEN intPUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_STOPPED' AND  sex = 'Female' AND age BETWEEN 30 AND 34 THEN intPUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_STOPPED' AND  sex = 'Female' AND age BETWEEN 35 AND 39 THEN intPUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_STOPPED' AND  sex = 'Female' AND age BETWEEN 40 AND 44 THEN intPUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_STOPPED' AND  sex = 'Female' AND age BETWEEN 45 AND 49 THEN intPUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_STOPPED' AND  sex = 'Female' AND age >= 50 THEN intPUuid END) AS female50,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_STOPPED' THEN intPUuid END) AS total

FROM
    AllData
UNION ALL

SELECT
    '' AS sno,
    'Transfer out' AS indicator,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_TRANSFER_OUT' AND  sex = 'Male' AND age BETWEEN 15 AND 19 THEN intPUuid END) AS male19,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_TRANSFER_OUT' AND  sex = 'Male' AND age BETWEEN 20 AND 24 THEN intPUuid END) AS male24,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_TRANSFER_OUT' AND  sex = 'Male' AND age BETWEEN 25 AND 29 THEN intPUuid END) AS male29,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_TRANSFER_OUT' AND  sex = 'Male' AND age BETWEEN 30 AND 34 THEN intPUuid END) AS male34,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_TRANSFER_OUT' AND  sex = 'Male' AND age BETWEEN 35 AND 39 THEN intPUuid END) AS male39,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_TRANSFER_OUT' AND  sex = 'Male' AND age BETWEEN 40 AND 44 THEN intPUuid END) AS male44,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_TRANSFER_OUT' AND  sex = 'Male' AND age BETWEEN 45 AND 49 THEN intPUuid END) AS male49,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_TRANSFER_OUT' AND  sex = 'Male' AND age >= 50 THEN intPUuid END) AS male50,

  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_TRANSFER_OUT' AND  sex = 'Female' AND age BETWEEN 15 AND 19 THEN intPUuid END) AS female19,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_TRANSFER_OUT' AND  sex = 'Female' AND age BETWEEN 20 AND 24 THEN intPUuid END) AS female24,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_TRANSFER_OUT' AND  sex = 'Female' AND age BETWEEN 25 AND 29 THEN intPUuid END) AS female29,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_TRANSFER_OUT' AND  sex = 'Female' AND age BETWEEN 30 AND 34 THEN intPUuid END) AS female34,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_TRANSFER_OUT' AND  sex = 'Female' AND age BETWEEN 35 AND 39 THEN intPUuid END) AS female39,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_TRANSFER_OUT' AND  sex = 'Female' AND age BETWEEN 40 AND 44 THEN intPUuid END) AS female44,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_TRANSFER_OUT' AND  sex = 'Female' AND age BETWEEN 45 AND 49 THEN intPUuid END) AS female49,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_TRANSFER_OUT' AND  sex = 'Female' AND age >= 50 THEN intPUuid END) AS female50,
  COUNT(DISTINCT CASE WHEN intType = 'PREP_STATUS_TRANSFER_OUT' THEN intPUuid END) AS total

FROM
    AllData
UNION ALL

SELECT
    '9' AS sno,
    'Volume of PrEP Dispensed' AS indicator,
    COALESCE(COUNT(DISTINCT CASE WHEN sex = 'Male' AND age BETWEEN 15 AND 19 THEN null END), 0) AS male19,
    COALESCE(COUNT(DISTINCT CASE WHEN sex = 'Male' AND age BETWEEN 20 AND 24 THEN null END), 0) AS male24,
    COALESCE(COUNT(DISTINCT CASE WHEN sex = 'Male' AND age BETWEEN 25 AND 29 THEN null END), 0) AS male29,
    COALESCE(COUNT(DISTINCT CASE WHEN sex = 'Male' AND age BETWEEN 30 AND 34 THEN null END), 0) AS male34,
    COALESCE(COUNT(DISTINCT CASE WHEN sex = 'Male' AND age BETWEEN 35 AND 39 THEN null END), 0) AS male39,
    COALESCE(COUNT(DISTINCT CASE WHEN sex = 'Male' AND age BETWEEN 40 AND 44 THEN null END), 0) AS male44,
    COALESCE(COUNT(DISTINCT CASE WHEN sex = 'Male' AND age BETWEEN 45 AND 49 THEN null END), 0) AS male49,
    COALESCE(COUNT(DISTINCT CASE WHEN sex = 'Male' AND age >= 50 THEN null END), 0) AS male50,

    COALESCE(COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 15 AND 19 THEN null END), 0) AS female19,
    COALESCE(COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 20 AND 24 THEN null END), 0) AS female24,
    COALESCE(COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 25 AND 29 THEN null END), 0) AS female29,
    COALESCE(COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 30 AND 34 THEN null END), 0) AS female34,
    COALESCE(COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 35 AND 39 THEN null END), 0) AS female39,
    COALESCE(COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 40 AND 44 THEN null END), 0) AS female44,
    COALESCE(COUNT(DISTINCT CASE WHEN sex = 'Female' AND age BETWEEN 45 AND 49 THEN null END), 0) AS female49,
    COALESCE(COUNT(DISTINCT CASE WHEN sex = 'Female' AND age >= 50 THEN null END), 0) AS female50,
    COALESCE(COUNT(DISTINCT null), 0) AS total

FROM
    AllData